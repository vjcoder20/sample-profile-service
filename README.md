# User-Profile-Service-RDS

## Introduction
To join the community Real Dev Squad, follow the instructions below and you will get the Discord Invite Link to join the server.

# Profile Service Feature
- User Profile Service consists of 3 APIs /health, /profile and /verification
- This is a template for creating your own NodeJs backend code of profile service.
- /health checks whether the server is up and running
- /profile returns data of the user to whom profile Service belong to. It is protected API so that not anyone can take your information.
- /verification API returns a hash based on the special chaincode generated by user at [identity service](https://my.realdevsquad.com/identity).
- This service is used by [Real Dev Squad](https://www.realdevsquad.com/) to connect and help new people come aboard to learn development.

# Tutorial
## What are you building?
Profile Service is your own service which will be deployed and verified by you with the help of some precreated APIs and contains all the relevant data of yours, used for building your profile and getting yourself a identity in Real Dev Squad. This service will be maintained by you throughout the term of your journey in Real Dev Squad.

## Pre-requisites (Should be installed)
- [VSCode](https://code.visualstudio.com/)
- [Git](https://git-scm.com/downloads)
- Account on [Render](https://render.com/)
- [Insomnia](https://insomnia.rest/) or [Postman](https://www.postman.com/)
- [NodeVersion 14.18.x](https://nodejs.org/en/download/releases/)
- [Yarn](https://classic.yarnpkg.com/lang/en/docs/install/#windows-stable)
## Steps to Follow
### Step 1
Fork the Template Repository from top right corner

![image](https://user-images.githubusercontent.com/76257739/172947921-801df257-497a-4dcb-a4ef-bddbdd8ff5fa.png)

### Step 2
Create a new fork, ensure that `Owner` is selected as your GitHub username and repository name can be named as : 
```
<YOUR_NAME>'s-profile-service

Example : rohan's-profile-service
``` 

![image](https://user-images.githubusercontent.com/78433013/165998794-0fb87f2a-7f49-45be-ac6e-01140f832409.png)

### Step 3
Now when you have forked the repository. We will clone the repository in our PC.

Click on `Code` button on right just above code

![gitclone](https://user-images.githubusercontent.com/76257739/172947992-5e1d1441-81c6-4bfa-95b8-2f8c86f3955a.png)

Ensure that HTTPS is selected and copy the link

Now enter following command in terminal to clone repository:

```git clone <link you have copied>```

### Step 4
Open the cloned repository in VScode or your code editor

### Step 5
Open New Terminal in VSCode and run following command 
```yarn``` or ```yarn install```
This will bring in all the packages and dependencies if any left.

## Making It your own
Now we will create a file local to you that contains all your profile data. We will use environment variables so that only you and authorized RDS service can access your data and not anyone who has your deployment link

### Step 1:
Add a file in your main folder and name it as `.env`

### Step 2:
Copy following data in your .env file and replace right side values with your real information
```
FIRST_NAME='first_name'
LAST_NAME='last_name'
EMAIL='email_id'
PHONE='your contact number'
YOE=your years of experience
COMPANY='Your company / University you are in'
DESIGNATION='Current Role'
GITHUB_ID='github_id<github_user_id not the full url>'
LINKEDIN_ID='linkedin_id<linkedin_user_id not the full url>'
TWITTER_ID='twitter_id<twitter_user_id not the full url>'
INSTAGRAM_ID='instagram_id<instagram_user_id not the full url>'
WEBSITE='your portfolio website. Leave empty if not there'
CHAIN_CODE='Your chain code. Will be generated in further steps when deploying'
```

### Note : Make sure you add all the keys, website can be optional.

### Step 3:
Add a [gitignore](https://www.atlassian.com/git/tutorials/saving-changes/gitignore) file and add .env file in it so it is not tracked and your personal information is never uploaded to Github.

## Lets Test It
Now we will test if our profile service is working on our local device before deploying

### Step 1
Open Insomnia and select debug in top center of screen

![image](https://user-images.githubusercontent.com/76257739/172949394-a10cf0c4-e866-47be-814c-eaf7bb12b831.png)

You will see above screen

### Step 2
Now go to VSCode and open your profile service and type following code in new terminal:
```yarn run dev```
This command will run your service locally

### Step 3
Open Insomnia and enter following link with GET Request
``` http://localhost:8000/health ```

![image](https://user-images.githubusercontent.com/76257739/172948422-770d4622-827b-4aa8-b2e7-0c915f29f86d.png)

![image](https://user-images.githubusercontent.com/76257739/172948268-17ec565c-7eba-4f92-ba6f-ad8feeda38e6.png)

Congratulations you have run your first service and tested your first API ðŸŽ‰ðŸŽ‰

### Step 4
To test other APIs we need to deploy our service and generate chaincode from RDS identity service which is used to verify your profile service

## Deployment
Now we will deploy our service so that it is running on a server and accessible to everyone and is not running only locally on your machine.

### Step 1
Login to your Render account. After logging in go to your dashboard and you will see this interface.

![image](https://user-images.githubusercontent.com/79859472/190889532-247d46b3-e396-49db-9ea7-bd7ee7811c69.png)

### Step 2
Click on `New` and you will see a dropdown having multiple options.

![image](https://user-images.githubusercontent.com/79859472/190889882-ab9340f9-c5b5-4fbe-bac3-5f7e53c14a85.png)

Click on `Web Service`

### Step 3
Now, you will be directed to a new page where you have to configure your GitHub or Gitlab account so that you can deploy your profile service on Render.

![image](https://user-images.githubusercontent.com/79859472/190889930-1ca8ae09-3ef1-46f6-a850-0eacc2d89d6b.png)

Now select your profile service repository to deploy.

Then click on `Connect`.

### Step 4
Now you will seeing your deploy section of the Render app as below.

![image](https://user-images.githubusercontent.com/79859472/190890103-49a2feae-9d83-4e5b-ac5a-d6af63d3fa38.png)

Now, fill in all the inputs correctly.

Then, select the Free tier as shown below,

![image](https://user-images.githubusercontent.com/79859472/190890223-19ab6a17-de9d-45a7-9d42-c4e3c0d41c0b.png)

### Step 5
Now click on the advanced option below the plans section.

### Step 6
You will find `Add Environment Variables` option along with other options. Leave others as default and click on the add environment variables button.

![Add Environment Variables](https://user-images.githubusercontent.com/79859472/190890279-8fa2ae49-96f8-4702-8d28-096da5f65710.png)

### Note : Make sure you add all the keys, website can be optional.

### Step 7
Make sure you clear cache and redeploy your service after storing env specifically chain_code.

### Step 8
Now you will find a box for Key and one box for Value.
Copy the first key from your .env file into the `KEY box` and copy its value(Without **apostrophes**) in the `VALUE box` and click on Add button. For empty values add a space in the VALUE box.

![keyval](https://user-images.githubusercontent.com/79859472/190890331-b4f7c987-a93a-444c-909e-3d3fe1730ce0.png)

### Step 9
Do Step 7 Repeatedly for all values of .env file but leave chaincode because that will be generated later on.

### Step 10
And you are done with deployment. Now only deployment link which is protected and you have your personal info and cannot even be uploaded by mistake on Github.

### Step 11
Finally, scroll down and you will find a button named `Create Web Service`. Click on that button to deploy your code.

![Create Web Service](https://user-images.githubusercontent.com/79859472/190890397-9266f794-3315-4a7c-8261-5f838ca61681.png)

ðŸ¥³ Congratulations, you have successfully deployed your profile service.

## Joining Us
Now you will be linking your deployed service with us i.e. RDS.

### Step 1
Go to [Real Dev Squad](https://www.realdevsquad.com/) website and click on `Sign In With GitHub` button in the navbar as shown below.

![image](https://user-images.githubusercontent.com/78433013/172817107-594451b4-eaeb-4997-8043-ece470218cbb.png)

Link your GitHub account, and complete the `SignUp` steps.
**Note** : Only for users who don't have an account on Real Dev Squad website or who haven't linked their GitHub account on Real Dev Squad website.

### Step 2
Go to [My Site](https://my.realdevsquad.com/) or you can simply click the user greeting as shown below (this is after you have Signed In with your GitHub account)

![image](https://user-images.githubusercontent.com/76257739/172948639-0aaa2aa7-4238-4b70-90fd-3a7fd485a985.png)

Once you landed on my-site, you will have to go to [Identity](https://my.realdevsquad.com/identity) Tab (P.S. you can directly click on this hyperlink to get you to the desired page).

### Step 3
You get to see something like the below form

![image](https://user-images.githubusercontent.com/78433013/172821914-024038d6-d886-4463-9e25-c4882b671261.png)

Click on `Generate Chaincode`, an alert will appear, click `OK` to generate the chaincode.

![image](https://user-images.githubusercontent.com/78433013/172822474-30441e6a-e0a8-4f9d-9e78-1edbb0906a3c.png)

Click on `Copy` to copy the chaincode.
**Note : Keep this generated code very safely as you will be able to see it once only.**

### Step 4
Now open the .env file in your profile service and paste the copied chaincode in front of the `CHAIN_CODE` key.
Also, Update the chaincode in deployment from `Dashboard -> click on your deployed service -> Environment -> update the chaincode` as discussed in Step 7 of Deployment.

Now we have completed all the information.

### Step 5
Now, push your code to the remote repository

`git add .`

`git commit -m "<ENTER_YOUR_COMMIT_MESSAGE>"`

If your branch name is `main` then use this

`git push origin main`

Otherwise,

```git push origin <ENTER_YOUR_BRANCH_NAME>```

### Step 6
Now that you have pushed your code with the chaincode. Enter your deployed service URL here.

![image](https://user-images.githubusercontent.com/78433013/172825385-a4e9000c-c4c2-4a43-a541-558098bad442.png)

And click on `Save`.
After that `Check` the checkbox to ensure that you have done both the steps correctly.
Then, click on `Link Chaincode`. Woooh, now wait for few seconds or minutes to get your service verified by the Real Dev Squad service.
Once you are verified you will get to see a verification message that your verification is completed.

![image](https://user-images.githubusercontent.com/78433013/172826282-140d4b22-ae5f-4f11-93cf-289b40deff73.png)

Awesome, Congratulations ðŸ¥³ ðŸŽ‰ on becoming a user in Real Dev Squad and
### Welcome to Real Dev Squad ðŸ¥³ ðŸŽ‰

**Note : ** If you are unable to verify your service or their are some errors that you get encountered. Please reach out to members of Real Dev Squad from [here](https://members.realdevsquad.com/)

## Additional Information

1. You can run `yarn run test` cmd in local after completing all information and see if any test is failing. If any of the test is failing please re check the information entered by you in .env file.
**These tests check the functionality of all three APIs.**
